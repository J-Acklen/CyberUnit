# Chaotic Mouse Script (No Admin Required)
# Randomly jumps cursor and changes mouse speed
# Press Ctrl+C to stop and restore settings

Add-Type -AssemblyName System.Windows.Forms
Add-Type @"
using System;
using System.Runtime.InteropServices;

public class MouseHelper {
    [DllImport("user32.dll")]
    public static extern bool SetCursorPos(int X, int Y);
    
    [DllImport("user32.dll")]
    public static extern bool SystemParametersInfo(uint uiAction, uint uiParam, IntPtr pvParam, uint fWinIni);
    
    [DllImport("user32.dll")]
    public static extern bool SystemParametersInfo(uint uiAction, uint uiParam, uint pvParam, uint fWinIni);
    
    public const uint SPI_SETMOUSESPEED = 0x0071;
    public const uint SPI_GETMOUSESPEED = 0x0070;
    public const uint SPIF_SENDCHANGE = 0x0002;
}
"@

# Get original mouse speed
$originalSpeed = New-Object int
$speedPtr = [System.Runtime.InteropServices.Marshal]::AllocHGlobal(4)
[MouseHelper]::SystemParametersInfo([MouseHelper]::SPI_GETMOUSESPEED, 0, $speedPtr, 0) | Out-Null
$originalSpeed = [System.Runtime.InteropServices.Marshal]::ReadInt32($speedPtr)
[System.Runtime.InteropServices.Marshal]::FreeHGlobal($speedPtr)

Write-Host "========================================" -ForegroundColor Red
Write-Host "     MOUSE CHAOS ACTIVATED!" -ForegroundColor Red
Write-Host "========================================" -ForegroundColor Red
Write-Host ""
Write-Host "Original mouse speed: $originalSpeed" -ForegroundColor Cyan
Write-Host ""
Write-Host "Features:" -ForegroundColor Yellow
Write-Host "  [X] Random cursor jumping + speed changes" -ForegroundColor Green
Write-Host ""
Write-Host "Press Ctrl+C to stop and restore settings..." -ForegroundColor Yellow
Write-Host ""

$random = New-Object System.Random

# Speed presets with descriptions
$speedLevels = @(
    @{Value = 1; Desc = "GLACIAL"},
    @{Value = 3; Desc = "SUPER SLOW"},
    @{Value = 5; Desc = "Slow"},
    @{Value = 8; Desc = "Sluggish"},
    @{Value = 10; Desc = "Normal"},
    @{Value = 12; Desc = "Brisk"},
    @{Value = 15; Desc = "Fast"},
    @{Value = 18; Desc = "SUPER FAST"},
    @{Value = 20; Desc = "LIGHTNING"}
)

try {
    while ($true) {
        $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds
        
        # Jump mouse to random position AND change speed
        $x = $random.Next(0, $screen.Width)
        $y = $random.Next(0, $screen.Height)
        
        # Change speed every time we jump
        $speedChoice = $speedLevels[$random.Next(0, $speedLevels.Length)]
        $newSpeed = $speedChoice.Value
        $speedDesc = $speedChoice.Desc
        
        [MouseHelper]::SystemParametersInfo([MouseHelper]::SPI_SETMOUSESPEED, 0, $newSpeed, [MouseHelper]::SPIF_SENDCHANGE) | Out-Null
        [MouseHelper]::SetCursorPos($x, $y) | Out-Null
        
        Write-Host "[CHAOS] Jumped to ($x, $y) with $speedDesc speed ($newSpeed)" -ForegroundColor Cyan
        
        # Random delay between jumps (0.5 to 2 seconds)
        $delay = $random.Next(500, 2000)
        Start-Sleep -Milliseconds $delay
    }
}
finally {
    Write-Host ""
    Write-Host "========================================" -ForegroundColor Green
    Write-Host "   Restoring to original settings..." -ForegroundColor Green
    Write-Host "========================================" -ForegroundColor Green
    
    # Restore mouse speed to original
    [MouseHelper]::SystemParametersInfo([MouseHelper]::SPI_SETMOUSESPEED, 0, $originalSpeed, [MouseHelper]::SPIF_SENDCHANGE) | Out-Null
    Write-Host "[OK] Mouse speed restored to $originalSpeed" -ForegroundColor Green
    
    Write-Host ""
    Write-Host "All settings restored! Mouse is back to normal." -ForegroundColor Green
}